
MyBankCryptoSystem is a simulated secure banking system built mainly using Flask. It demonstrates a multi‐role banking application (clients, employees, and administrators) with features such as AES encryption, HTTPS, SSL/TLS, HMAC integrity checks, digital signatures, key rotation, and multi‐factor authentication.


**Note:** This project is for educational and demonstration purposes only.

**Table of Contents**

# Features
- **User Roles:** Clients, Employees, and Administrators.
- **Encryption when data at rest:** AES-CBC
- **Encryption when data in transit:** HTTPS, SSL/TLS
- **Integrity & Non-repudiation:** HMAC and Digital Signature
- **Key Management:** Auto-rotation of the master key with re-encryption of data and configurable rotation parameters.
- **Multi-Factor Authentication (MFA):** Secure login process for all user roles.
- **Front-end & Responsive UI:** HTML and CSS, built using Bootstrap 5 with a modern design.
- **Back-End & Database:** Python 3 and MySQL/SQLite

# Project Structure
```
MyBankCryptoSystem/                  # Root Directory
├── app.py                           # Flask web app entry (main)
├── config.py                        # Load .env and config scheduler
├── requirements.txt                 # Required Python libraries
├── .env                             # Environmantal Variables (SECRET_KEY, DB_URI for connect database)
├── extensions.py                    # Use SQLAlchemy connect models.py to database
├── instance/                        # Store database for this web app
│   └── mybank.db                    # Main database of this project
├── migrations/                      # Database migration files, generated by flask db migrate command
├── blueprints/                      # All the blueprints of all the features
│   ├── auth.py                      # Client authentication and authorisation (Register, Login, MFA, Logout)
│   ├── transaction.py               # Transaction feature (Init transaction, view transaction records)
│   ├── account.py                   # Client account (Deposit, withdraw and settings)
│   ├── employee.py                  # Employee features (Authentication and authorisation, client management, transaction approval, logs...)
│   ├── message.py                   # Message feature (Send, receive and view messages)
│   └── admin.py                     # Admin features (Authentication and authorisation, user management, key management and audit)
├── db/                              # Database models
│   └── models.py                    # SQLAlchemy model（User、Transaction、Message、KeyStore、OperationLog）
├── crypto/                          # Cryptogrphy and security relevant
│   ├── encryption.py                # Key management system, encryption and decryption algorithms, and data reencryption
│   ├── integrity.py                 # HMAC generation and verification
│   └── digital_signature.py         # Digital signature (Key pair generation, data signing and verification)
├── scheduler.py                     # Using APScheduler to automatically rotate keys
├── static/                          # Store background image for the front page of web app
├── templates/                       # Front-end files (HTML)
└── README.md                        # Current File
```

# Installation and Setup 

**1. Use the zip I provided or clone the Repository**
```
git clone https://github.com/haoxuanyuan007/BankCryptoSystem.git
cd MyBankCryptoSystem
```

**2. Create and Activate a Virtual Environment**

Navigate to the place you want to store the project, then run following commands:
(NOTE: Depending on your machine, you might need to swap python to python 3)
```
# Create virtual environment
python -m venv .venv

# Then everytime you run the project, you need to activate it
# On Unix/macOS:
source .venv/bin/activate
# On Windows:
.venv\Scripts\activate
```

**3. Install Dependencies**

Navigate to root directory of the project

```
cd MyBankCryptoSystem
```

```
pip install -r requirements.txt
```


**4. Running the Application**


You can start the application with:

```
flask run --cert=cert.pem --key=key.pem
```

Or run the main application file directly:

```
python app.py
```

This will start a web app on your device's localhost 
and port number will be 5000, you should be able to see something like this in your terminal:
```
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on https://127.0.0.1:5000
Press CTRL+C to quit
 * Serving Flask app 'app.py'
 * Debug mode: off
```
You can simply open your browser and visit https://127.0.0.1:5000 to use web app


# Usage

- **Clients** can register, log in, deposit/withdraw funds, initiate transactions, view transaction history, send message and update personal settings.

- **Employees** can log in, review pending transactions, view audit logs, send message and perform client operations.

- **Administrators** can log in, manage users (add/update/delete employees, update roles), view audit logs, and adjust key rotation configurations.


For a detailed walkthrough of the features, refer to the documentation within each blueprint directory.


# Account that created
**Client:**

Username: client1   Password: client1_password

Username: client2   Password: client2_password

Username: client3   Password: client3_password


**Employee**:

Username: employee1   Password: emp1_password

Username: employee2   Password: emp2_password

Username: employee3   Password: emp3_password


**Admin**:

Username: admin   Password: admin_password




# Running Test Script
Before running test script, go to app.py and comment out these lines:
```
# with app.app_context():
#      init_keys(app)
#      Config.ENCRYPTION_KEY = app.config["ENCRYPTION_KEY"]
#      Config.KEY_VERSION = app.config["KEY_VERSION"]
# 
# init_scheduler(app)
```
Then run following command in the project root directory:

```
python -m unittest tests/test_security.py 
```
If the output is like this:

```
----------------------------------------------------------------------
Ran 8 tests in 2.198s
OK

```
It proves that all tests have passed.



# Viewing the Database

To quickly inspect the SQLite database, you can use a tool like [DB Browser for SQLite](https://sqlitebrowser.org/) or [Navicat for SQLite](https://www.navicat.com/en/products/navicat-for-sqlite).


# Troubleshooting

**Database Connection Issues:**
- Ensure the DB_URI in .env is correct.

**Key Rotation Issues:**

- Check the KeyStore table to verify key records.

- Review log output (configured in crypto/encryption.py and crypto/digital_signature.py) for errors.

**Environment Issues:**

- Verify that all dependencies are installed.

- Activate the virtual environment before running commands.



**License**


This project is for educational and demonstration purposes only.
